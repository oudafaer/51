C51 COMPILER V9.59.0.0   MAIN                                                              01/29/2022 01:49:23 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\SCM\keil 4\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\m
                    -ain.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "reg52.h"  //单片机头文件
   2          
   3          typedef unsigned int u16;         //对数据类型进行声明定义
   4          typedef unsigned char u8;
   5          
   6          //位定义
   7          sbit k1=P3^4;
   8          sbit k2=P3^5;
   9          sbit k3=P3^6;
  10          sbit k4=P3^7;
  11          
  12          //函数声明
  13          void Delay_ms(unsigned int xms);
  14          void Uart_Init(void);
  15          void Uart_Send_Byte(unsigned char c);
  16          void keycontrol(void);
  17          
  18          //主函数
  19          void main()
  20          {
  21   1              Uart_Init();
  22   1              while(1)
  23   1              {
  24   2                      keycontrol();
  25   2              }
  26   1      }
  27          //延时函数
  28          void Delay_ms(unsigned int xms)
  29          {   
  30   1              unsigned char i,j;                        
  31   1              for(i=xms;i>0;i--)
  32   1                      for(j=110;j>0;j--);
  33   1      }
  34          //串口参数初始化设置函数
  35          void Uart_Init(void)
  36          {
  37   1          SCON=0x50;                  //串口工作方式1:10位异步收发器，1位起始位，8位数据位，1位停止位;REN=1:允许
             -接收 
  38   1      //    PCON=0x00;4800 9600                //SMOD=0:波特率不加倍 
  39   1          TMOD=0x20;                  //定时器T1工作方式2，8位自动重装载定时器/计数器，用于UART波特率 
  40   1          TH1=0xFD;                   //定时器初值设置0xFD，单片机晶振11.0592MHz，对应波特率9600
  41   1          TL1=0x00;                   //无需设置该位，保持为0x00
  42   1          TR1=1;                          //开启定时器T1，允许T1计数 
  43   1              SM0=0;                      //设置串口工作方式
  44   1          SM1=1;
  45   1              ES=1;                       //串口中断允许位置1，开启串口中断
  46   1          EA=1;                       //总中断允许位，开启总中断
  47   1      }
  48          //串口发送一个字节函数
  49          void Uart_Send_Byte(unsigned char c)
  50          {
  51   1              SBUF = c;                     //将传入的数据赋值给发送缓冲器SBUF，将数据发送出去
  52   1              while(!TI);                             //等待数据发送完成，发送完成后发送中断标志位TI被硬件置1，跳出循环
  53   1              TI = 0;                       //发送中断标志位TI软件清零，为下次发送数据做准备
C51 COMPILER V9.59.0.0   MAIN                                                              01/29/2022 01:49:23 PAGE 2   

  54   1      }
  55          //按键控制
  56          void keycontrol(void)
  57          {
  58   1              unsigned char keynumber=0;
  59   1              if(k1==0)
  60   1              {
  61   2                      Delay_ms(10);
  62   2                      while(k1==0);
  63   2                      Delay_ms(10);
  64   2                      keynumber=1;
  65   2                      Uart_Send_Byte(keynumber);
  66   2              }
  67   1                      if(k2==0)
  68   1              {
  69   2                      Delay_ms(10);
  70   2                      while(k2==0);
  71   2                      Delay_ms(10);
  72   2                      keynumber=2;
  73   2                      Uart_Send_Byte(keynumber);
  74   2              }
  75   1              if(k3==0)
  76   1              {
  77   2                      Delay_ms(10);
  78   2                      while(k3==0);
  79   2                      Delay_ms(10);
  80   2                      keynumber=3;
  81   2                      Uart_Send_Byte(keynumber);
  82   2              }
  83   1              if(k4==0)
  84   1              {
  85   2                      Delay_ms(10);
  86   2                      while(k4==0);
  87   2                      Delay_ms(10);
  88   2                      keynumber=4;
  89   2                      Uart_Send_Byte(keynumber);
  90   2              }
  91   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    152    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
